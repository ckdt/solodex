<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solodex</title>
  <meta name="description" content="Solodex — start building here" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <h1>
      <img src="assets/img/logo-full.svg" alt="Solodex" title="solodex" class="img"/></h1>
    <h2>Ditch the updates, save your contacts.</h2>
  </header>

  <main>
   

    <div class="base">
      <div class="base__top">
      <div class="side side--left">
        <div class="knob knob--left">
          <div class="knob__dial">
            <div class="knob__dial__glimpse"></div>
          </div>
          <div class="knob__shaft"></div>
        </div>
        <div class="arm arm--left">
          <div class="arm__bottom"></div>
        </div>
      </div>
      <div class="middle">
        <div class="middle__top">

          <div class="card__ring">
            <div class="card__ring__inner"></div>
            <div class="card__ring__inner"></div>
          </div>

          <div class="cards__list">
            <!-- Cards will be dynamically generated here -->
          </div>
        </div>
        <div class="middle__bottom">
          <div class="middle__bottom__branding">
            <img src="assets/img/logo.svg" alt="Solodex Logo" />
          </div>
        </div>

      </div>

      <div class="side side--right">
        <div class="arm arm--right">
          <div class="arm__bottom"></div>
        </div>
        <div class="knob knob--right">
          <div class="knob__dial">
            <div class="knob__dial__glimpse"></div>
          </div>
          <div class="knob__shaft"></div>
        </div>
      </div>
     
      </div>
      <div class="base__bottom">
         <img src="assets/img/base-footer.svg" alt="Solodex footer" />
      </div>
    </div>

  <footer>
    <small>&copy; <span id="year"></span></small>
  </footer>

  <script>
    // Contact data (10 sample entries)
    const contactsData = [
      { name: 'Ronny Wieckardt', title: 'Digital Designer', email: 'ronny@allthis.digital', website: 'allthis.digital', websiteUrl: 'https://allthis.digital', notes: 'Creative director & interaction designer' },
      { name: 'Jane Smith', title: 'Product Manager', email: 'jane@example.com', website: 'example.com', websiteUrl: 'https://example.com', notes: 'Leading product innovation' },
      { name: 'John Developer', title: 'Full Stack Engineer', email: 'john@example.com', website: 'johndeveloper.dev', websiteUrl: 'https://johndeveloper.dev', notes: 'Building scalable solutions' },
      { name: 'Alice Parker', title: 'UX Researcher', email: 'alice@example.com', website: 'aliceux.io', websiteUrl: 'https://aliceux.io', notes: 'User research & testing' },
      { name: 'David Kim', title: 'Visual Designer', email: 'david@example.com', website: 'dkdesigns.com', websiteUrl: 'https://dkdesigns.com', notes: 'Branding and illustration' },
      { name: 'Maria Lopez', title: 'Engineer', email: 'maria@example.com', website: 'marialo.dev', websiteUrl: 'https://marialo.dev', notes: 'Frontend engineer' },
      { name: 'Tom Baker', title: 'DevOps', email: 'tom@example.com', website: 'tomb.io', websiteUrl: 'https://tomb.io', notes: 'Infrastructure & CI/CD' },
      { name: 'Zoe Chen', title: 'Data Scientist', email: 'zoe@example.com', website: 'zoe.ai', websiteUrl: 'https://zoe.ai', notes: 'ML & analytics' },
      { name: 'Liam Brown', title: 'QA Lead', email: 'liam@example.com', website: 'liamtest.com', websiteUrl: 'https://liamtest.com', notes: 'Quality assurance' },
      { name: 'Nina Rossi', title: 'Content Strategist', email: 'nina@example.com', website: 'ninarossi.com', websiteUrl: 'https://ninarossi.com', notes: 'Content & editorial' }
    ];

    let currentIndex = 0; // index of the top/front card
    let isAnimating = false;
    let topCard = null;
    let bottomCard = null;

    function createCardElement(contact, role) {
      const card = document.createElement('div');
      card.className = `card vertical card--${role}`;

      card.innerHTML = `
        <div class="card__container">
          <div class="card__front">
            <p><strong>${contact.name}</strong></p>
            <p>${contact.title}</p>
            <p>
              <a href="mailto:${contact.email}">${contact.email}</a><br />
              <a href="${contact.websiteUrl}">${contact.website}</a>
            </p>
          </div>
          <div class="card__back">
            
           <!-- <p><strong>${contact.name}</strong></p>
            <p>${contact.notes}</p>-->
          </div>
        </div>
      `;

      return card;
    }

    function renderTwoSlots(index) {
      const cardsList = document.querySelector('.cards__list');
      cardsList.innerHTML = '';

      const n = contactsData.length;
      const topContact = contactsData[index];
      // create top card
      topCard = createCardElement(topContact, 'top');
      topCard.style.top = `0rem`;
      topCard.style.zIndex = 2;
      cardsList.appendChild(topCard);

      // create bottom card if we're NOT at the last card
      if (index < n - 1) {
        const bottomContact = contactsData[index + 1];
        bottomCard = createCardElement(bottomContact, 'bottom');
        bottomCard.style.top = `1rem`;
        bottomCard.style.zIndex = 1;
        cardsList.appendChild(bottomCard);
      } else {
        bottomCard = null;
      }
      
      // always set height to show both cards (or just top if no bottom)
      cardsList.style.height = bottomCard 
        ? `calc(var(--card-height) + var(--slot-gap))` 
        : `var(--card-height)`;
    }

    function attachScrollDownOnly() {
      // clear previous handler and attach to document (entire page)
      document.removeEventListener('wheel', rolodexWheel);
      document.addEventListener('wheel', rolodexWheel, { passive: false });

      function rolodexWheel(e) {
        e.preventDefault();
        if (isAnimating) return;

        const delta = e.deltaY;
        if (delta > 0) {
          // scroll down — flip top away, flip bottom into front
          // if there's no bottom card (first card), do nothing
          if (!bottomCard) return;

          isAnimating = true;

          topCard.classList.add('flip-away');
          bottomCard.classList.add('flip-in');

          const bottomContainer = bottomCard.querySelector('.card__container');

          const onBottomEnd = (ev) => {
            if (ev.target !== bottomContainer) return;
            bottomContainer.removeEventListener('transitionend', onBottomEnd);

            // advance index and re-render two slots
            if (currentIndex + 1 < contactsData.length) {
              currentIndex = currentIndex + 1;
              renderTwoSlots(currentIndex);
            }

            // small timeout to allow DOM to settle before re-enabling
            setTimeout(() => {
              isAnimating = false;
            }, 20);
          };

          bottomContainer.addEventListener('transitionend', onBottomEnd);
        }
        else if (delta < 0) {
          // scroll up — bring previous card from above into top slot
          isAnimating = true;
          const cardsList = document.querySelector('.cards__list');

          const n = contactsData.length;
          if (currentIndex === 0) {
            isAnimating = false;
            return; // already at the first card
          }
          const prevIndex = currentIndex - 1;
          const prevContact = contactsData[prevIndex];

          const prevCard = createCardElement(prevContact, 'top');
          // position above the top card
          prevCard.style.top = `-1rem`;
          prevCard.style.zIndex = 30;
          // start pre-flipped (hidden above)
          prevCard.classList.add('pre-flip');

          // insert before current topCard
          cardsList.insertBefore(prevCard, topCard);

          // animate: flip current top downward and bring prevCard into front
          requestAnimationFrame(() => {
            requestAnimationFrame(() => {
              // remove the pre-flip (no-transition) so the regular transition applies
              prevCard.classList.remove('pre-flip');
              // trigger the flip-in and flip-away-down
              prevCard.classList.add('flip-in');
              topCard.classList.add('flip-away-down');
            });
          });

          const prevContainer = prevCard.querySelector('.card__container');
          const onPrevEnd = (ev) => {
            if (ev.target !== prevContainer) return;
            prevContainer.removeEventListener('transitionend', onPrevEnd);

            // update index and re-render
            currentIndex = prevIndex;
            renderTwoSlots(currentIndex);

            setTimeout(() => { isAnimating = false; }, 20);
          };

          prevContainer.addEventListener('transitionend', onPrevEnd);
        }
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('year').textContent = new Date().getFullYear();
      renderTwoSlots(currentIndex);
      attachScrollDownOnly();
    });
  </script>
</body>
</html>